---
// Simple PDF Generator - Uses browser print with optimized CSS
---

<div id="pdf-generator">
  <button 
    id="generate-pdf-btn" 
    class="inline-flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors duration-200"
    type="button"
  >
    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
    </svg>
    <span>Imprimer en PDF</span>
  </button>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const generateBtn = document.getElementById('generate-pdf-btn') as HTMLButtonElement;
    
    if (!generateBtn) return;
    
    generateBtn.addEventListener('click', function() {
      // Add PDF-specific styles to the page
      const style = document.createElement('style');
      style.id = 'pdf-print-styles';
      style.textContent = `
        @media print {
          /* Hide elements that shouldn't appear in PDF */
          nav, footer, .no-print, #pdf-generator {
            display: none !important;
          }
          
          /* Optimize page layout for PDF */
          body {
            font-size: 12pt;
            line-height: 1.4;
            color: #000;
            background: white;
          }
          
          /* Ensure proper page breaks */
          .cv-section {
            break-inside: avoid;
            margin-bottom: 1rem;
          }
          
          /* Optimize images for print */
          img {
            max-width: 100%;
            height: auto;
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
          }
          
          /* Preserve colors and backgrounds */
          * {
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
          }
          
          /* Optimize typography */
          h1, h2, h3 {
            color: #1f2937;
            break-after: avoid;
          }
          
          /* Remove shadows and effects */
          .shadow, .shadow-lg, .shadow-md {
            box-shadow: none !important;
          }
          
          /* Ensure proper spacing */
          .container {
            max-width: none;
            padding: 0;
          }
        }
      `;
      
      document.head.appendChild(style);
      
      // Trigger print dialog
      setTimeout(() => {
        window.print();
        
        // Remove print styles after printing
        setTimeout(() => {
          const printStyle = document.getElementById('pdf-print-styles');
          if (printStyle) {
            printStyle.remove();
          }
        }, 1000);
      }, 100);
    });
  });
</script>

<style>
  /* PDF-specific styles that will be applied when ?pdf=true is in URL */
  @media screen {
    body[data-pdf-mode="true"] footer,
    body[data-pdf-mode="true"] .no-pdf,
    body[data-pdf-mode="true"] button:not(.pdf-keep),
    body[data-pdf-mode="true"] [onclick]:not(.pdf-keep) {
      display: none !important;
    }
    
    body[data-pdf-mode="true"] .glass-card {
      background: white !important;
      border: 1px solid #e5e7eb !important;
      box-shadow: none !important;
      backdrop-filter: none !important;
    }
    
    body[data-pdf-mode="true"] {
      background: white !important;
    }
  }
</style>

<script is:inline>
  // Check if we're in PDF mode and apply styles
  if (window.location.search.includes('pdf=true')) {
    document.body.setAttribute('data-pdf-mode', 'true');
  }
</script>
